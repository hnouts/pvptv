{{define "class"}}
<!DOCTYPE html>
<html lang="en">
<head>
    {{template "head" .}}
</head>
<body>
<div class="shell fill background">
    <!-- SIDEBAR (Specific to Class) -->
    <div class="nav fill">
        <div class="app-title hspace-out middle">
            <header>
                <a class="hApp focus glow" href="/">â†© HOME</a>
            </header>
        </div>
        
        <nav class="nav-content">
            <div class="nav-streams-class-selected">
                <div class="nav-streams-stack">
                    <div class="hspace-out">
                        <div class="separator"></div>
                        <h3 class="hApp h3">Streaming</h3>
                        {{range .Channels}}
                            {{$stream := index . "stream"}}
                            {{$online := index $stream "online"}}
                            {{$game := index $stream "game"}}
                            {{if and $online (eq $game "World of Warcraft")}}
                                {{$slug := index . "slug"}}
                                {{$name := index . "name"}}
                                {{$viewers := index $stream "viewers"}}
                                <div class="stream-label-style">
                                    <a class="glow icon-circle main" href="/{{$.ClassSlug}}/{{$slug}}" id="{{$slug}}">
                                        <span>{{$name}}</span>
                                    </a>
                                    <a class="glow unresponsive spaced-on-mobile" href="/{{$.ClassSlug}}/{{$slug}}" id="{{$slug}}">
                                        <span>ðŸ”´ {{$viewers}}</span>
                                    </a>
                                </div>
                            {{end}}
                        {{end}}
                        <div class="separator"></div>
                        <h3 class="hApp h3">Offline</h3>
                        {{range .Channels}}
                            {{$stream := index . "stream"}}
                            {{$online := index $stream "online"}}
                            {{$game := index $stream "game"}}
                            {{if or (not $online) (ne $game "World of Warcraft")}}
                                {{$slug := index . "slug"}}
                                {{$name := index . "name"}}
                                <div class="stream-offline">
                                    <a class="offlineLink" href="/{{$.ClassSlug}}/{{$slug}}" id="{{$slug}}">
                                        <span>{{$name}}</span>
                                    </a>
                                </div>
                            {{end}}
                        {{end}}
                    </div>
                </div>
            </div>
        </nav>
    </div>

    <!-- MAIN CONTENT (Player) -->
    <div class="content fill">
        <div class="stream-player fill">
             <div id="twitch-player" style="width:100%;height:100%"></div>
        </div>
    </div>
</div>

<script src="https://player.twitch.tv/js/embed/v1.js"></script>
<script>
    // Auto-load first online stream
    {{range .Channels}}
        {{$stream := index . "stream"}}
        {{$online := index $stream "online"}}
        {{$game := index $stream "game"}}
        {{if and $online (eq $game "World of Warcraft")}}
            {{$slug := index . "slug"}}
            var player = new Twitch.Player("twitch-player", {
                channel: "{{$slug}}",
                parent: window.location.hostname === "localhost" || window.location.hostname === "127.0.0.1" ? ["localhost", "127.0.0.1"] : ["pvptv.hnts.dev", "hnts.dev"]
            });
            // We only want the first one
            {{break}}
        {{end}}
    {{end}}
</script>
</body>
</html>
{{end}}
